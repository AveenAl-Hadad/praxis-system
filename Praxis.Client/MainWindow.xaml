<Window x:Class="Praxis.Client.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:conv="clr-namespace:Praxis.Client.Converters"
        Title="PraxisSystem - Patienten" Height="650" Width="1100"
        WindowStartupLocation="CenterScreen">
    
    <Window.Resources>
        <conv:BoolToActiveTextConverter x:Key="ActiveText"/>
    </Window.Resources>
    
    <Grid Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Toolbar -->
        <DockPanel Grid.Row="0" LastChildFill="True" Margin="0,0,0,10">
           <StackPanel Orientation="Vertical">
                <!-- Reihe 1: Titel + Suche -->
                <Grid Margin="0,0,0,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <TextBlock Grid.Column="0"
                       Text="Patientenliste"
                       FontSize="18"
                       FontWeight="SemiBold"
                       VerticalAlignment="Center"/>

                    <!-- Suche (mit Placeholder-Overlay) -->
                    <Grid Grid.Column="1" Width="260" Height="32">
                        <TextBox x:Name="SearchBox"
                         VerticalContentAlignment="Center"
                         TextChanged="SearchBox_TextChanged"/>

                        <TextBlock Text="Suche..."
                           Margin="8,0,0,0"
                           VerticalAlignment="Center"
                           Foreground="Gray"
                           IsHitTestVisible="False">
                            <TextBlock.Style>
                                <Style TargetType="TextBlock">
                                    <Setter Property="Visibility" Value="Collapsed"/>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding Text, ElementName=SearchBox}" Value="">
                                            <Setter Property="Visibility" Value="Visible"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </TextBlock.Style>
                        </TextBlock>
                    </Grid>
                </Grid>

                <!-- Reihe 2: Buttons -->
                <WrapPanel>
                    <Button Content="➕ Patient hinzufügen" Width="170" Height="30" Margin="0,0,10,8" Click="AddPatient_Click"/>
                    <Button Content="✏ Bearbeiten" Width="120" Height="30" Margin="0,0,10,8" Click="EditPatient_Click"/>
                    <Button Content="🗑 Löschen" Width="120" Height="30" Margin="0,0,10,8" Click="DeletePatient_Click"/>
                    <Button Content="⭐ Aktiv/Inaktiv" Width="140" Height="30" Margin="0,0,10,8" Click="ToggleActive_Click"/>
                    <Button Content="📤 Export CSV" Width="130" Height="30" Margin="0,0,10,8" Click="ExportCsv_Click"/>
                    <Button Content="Aktualisieren" Width="120" Height="30" Margin="0,0,10,8" Click="Refresh_Click"/>
                </WrapPanel>

            </StackPanel>
        </DockPanel>

        <!-- DataGrid -->
        <DataGrid Grid.Row="1" x:Name="PatientsGrid"
          AutoGenerateColumns="False"
          CanUserAddRows="False"
          IsReadOnly="True"
          SelectionMode="Single"
          SelectionUnit="FullRow"
          MouseDoubleClick="PatientsGrid_DoubleClick">

            <DataGrid.RowStyle>
                <Style TargetType="DataGridRow">
                    <Style.Triggers>
                        <!-- Inaktiv -->
                        <DataTrigger Binding="{Binding IsActive}" Value="False">
                            <Setter Property="Background" Value="#FFF8D7DA"/>
                            <!-- hellrot -->
                        </DataTrigger>

                        <!-- Aktiv -->
                        <DataTrigger Binding="{Binding IsActive}" Value="True">
                            <Setter Property="Background" Value="#FFE6FFED"/>
                            <!-- hellgrün -->
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </DataGrid.RowStyle>

            <DataGrid.Columns>
                <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="70"/>
                <DataGridTextColumn Header="Nachname" Binding="{Binding Nachname}" Width="2*"/>
                <DataGridTextColumn Header="Vorname" Binding="{Binding Vorname}" Width="2*"/>
                <DataGridTextColumn Header="Geburt" Binding="{Binding Geburtsdatum, StringFormat=d}" Width="120"/>
                <DataGridTextColumn Header="Alter" Binding="{Binding Alter}" Width="80"/>
                <DataGridTextColumn Header="E-Mail" Binding="{Binding Email}" Width="2*"/>
                <DataGridTextColumn Header="Telefon" Binding="{Binding Telefonnummer}" Width="160"/>
                <DataGridTemplateColumn Header="Status" Width="110">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock FontWeight="SemiBold" HorizontalAlignment="Center">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock">
                                        <!-- Default -->
                                        <Setter Property="Text" Value="Inaktiv"/>
                                        <Setter Property="Foreground" Value="Red"/>

                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsActive}" Value="True">
                                                <Setter Property="Text" Value="Aktiv"/>
                                                <Setter Property="Foreground" Value="Green"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>

        </DataGrid>
        <!-- Status -->
        <TextBlock Grid.Row="2" x:Name="StatusText"
                   Margin="0,10,0,0"
                   Foreground="Gray"/>
    </Grid>
</Window>